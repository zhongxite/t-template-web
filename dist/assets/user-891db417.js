import{_ as te,f as n,r as i,o as T,g as Z,a as j,b as t,u as a,k as p,w as r,F as G,q as oe,v as P,l as y,c as O,H as se,B as re,C as ne,t as ue,m as E,x as k}from"./index-8906f66a.js";import{a as ie,d as pe,u as de,c as me}from"./user-b4b83a6b.js";import{g as fe}from"./role-15182004.js";import{c as R}from"./common-fd5caf10.js";import{i as ce}from"./defaultImg-9e4ff219.js";const ge={class:"mainBox"},be={class:"subBtn"},ve={__name:"user",setup(_e){let D=n(ce);const A=E(()=>k(()=>import("./index-c2ba8daf.js"),["assets/index-c2ba8daf.js","assets/index-8906f66a.js","assets/index-09d74362.css","assets/index-3b6c3937.css"])),J=E(()=>k(()=>import("./index-39eafc3f.js"),["assets/index-39eafc3f.js","assets/index-8906f66a.js","assets/index-09d74362.css","assets/common-fd5caf10.js","assets/index-05f08c60.css"])),M=E(()=>k(()=>import("./index-4c6e7f52.js"),["assets/index-4c6e7f52.js","assets/index-8906f66a.js","assets/index-09d74362.css","assets/index-97b37711.css"]));let u=n({pageNum:1,page:10});const S=n([{type:"input",label:"姓名",prop:"name",placeholder:"请输入名称",defaultData:""},{type:"select",label:"性别",prop:"sex",placeholder:"请选择性别",defaultData:"",option:[{label:"男",value:1},{label:"女",value:2},{label:"未知",value:0}]},{type:"select",label:"状态",prop:"status",placeholder:"请选择状态",defaultData:"",option:[{label:"禁用",value:1},{label:"启动",value:2}]},{type:"daterange",label:"创建时间",prop:"createDate",format:"x",branchValue:{start:"createStartTime",end:"createEndTime"}},{type:"daterange",label:"最后登录时间",prop:"loginDate",format:"x",branchValue:{start:"loginStartTime",end:"loginEndTime"}}]),F=n({left:[{name:"创建",type:"",color:"#626aef",listeners:{click:()=>{b="创建用户",o.value={},v.value=[],_.value=!1,c.value=!0}}}],right:[{name:"刷新",type:"info",listeners:{click:()=>{f()}}}]});let C=n([]);const f=()=>{g.value=!0,ie({...u.value}).then(s=>{fe().then(e=>{e.code==200&&(C.value=e.data)}),s.code==200&&(s.data.list.forEach(e=>{e.status==0?e.status="启用":e.status="禁用",e.created&&(e.created=R(e.created)),e.loginTime&&(e.loginTime=R(e.loginTime))}),x.value=s.data.list,V.value=s.data.total,g.value=!1)})},W=(s,e)=>{u.value={...u.value,...s},e=="search"&&f()},I=n([{type:"text",label:"姓名",prop:"name",width:100,isShowZero:!1},{type:"img",label:"头像",prop:"avatar",width:100,isShowZero:!1,previewListName:""},{type:"tag",label:"性别",prop:"sex",isShowZero:!1,width:100},{type:"tag",label:"手机号码",prop:"phone",isShowZero:!1,width:200},{type:"text",label:"邮箱",prop:"email",isShowZero:!1,width:200},{type:"tag",label:"状态",prop:"status",isShowZero:!1,width:100},{type:"tag",label:"最后登录ip",prop:"loginIp",isShowZero:!1,width:140},{type:"text",label:"最后登录时间",prop:"loginTime",isShowZero:!1,width:140},{type:"text",label:"创建时间",prop:"created",isShowZero:!1,minWidth:140},{type:"btn",label:"操作",width:200,list:s=>[{name:"编辑",type:"",color:"#626aef",show:!0,listeners:{click:()=>{b="编辑用户",o.value={...s},v.value=[],_.value=!0,c.value=!0}}},{name:"删除",type:"",color:"#e47470",show:!0,listeners:{click:()=>{oe.confirm("是否删除此用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{pe({id:s.id}).then(e=>{e.code==200&&(P({message:"删除成功",type:"success"}),f())})}).catch(()=>{})}}}]}]);let x=n([]),g=n(!1),V=n(0);const z=s=>{u.value.pageNum=s,f()};let c=n(!1),U=n("500"),b=n("创建用户"),o=n({id:"",avatar:"",name:"",sex:"",phone:"",email:"",accountName:"",role:""}),v=n([]);const H=s=>{const e=s.name.substring(s.name.lastIndexOf(".")+1);if(["jpg","jpeg","png","gif","JPG","JPEG","GIF"].indexOf(e)===-1)return P({message:"上传文件只能是 jpg、jpeg、png、gif格式",type:"error"}),!1;if(!(s.size/1024/1024<2))return P({message:"上传文件大小不能超过 2MB",type:"error"}),!1},K=s=>{o.value.avatar=s.data.url};let _=n(!1),d=n(!1),w=n(!1);const B=()=>{c.value=!1,d.value=!1,w.value=!1},Q=()=>{d.value=!0,_.value?de(o.value).then(s=>{s.code==200?setTimeout(()=>{d.value=!1,w.value=!0,setTimeout(()=>{B(),f()},1e3)},1e3):d.value=!1}).catch(()=>{d.value=!1}):me(o.value).then(s=>{s.code==200?setTimeout(()=>{d.value=!1,w.value=!0,setTimeout(()=>{B(),f()},1e3)},1e3):d.value=!1}).catch(()=>{d.value=!1})};return f(),(s,e)=>{const q=i("el-image"),L=i("el-button"),X=i("el-upload"),m=i("el-form-item"),h=i("el-input"),N=i("el-radio"),Y=i("el-radio-group"),$=i("el-option"),ee=i("el-select"),le=i("el-form"),ae=i("el-scrollbar");return T(),Z(G,null,[j("div",ge,[t(a(A),{queryFormList:a(S),"onUpdate:queryFormList":e[0]||(e[0]=l=>p(S)?S.value=l:null),queryForm:a(u),"onUpdate:queryForm":e[1]||(e[1]=l=>p(u)?u.value=l:u=l),operateBtnList:a(F),"onUpdate:operateBtnList":e[2]||(e[2]=l=>p(F)?F.value=l:null),onClickSearch:W},null,8,["queryFormList","queryForm","operateBtnList"]),t(a(J),{modelValue:a(I),"onUpdate:modelValue":e[3]||(e[3]=l=>p(I)?I.value=l:null),tableList:a(x),"onUpdate:tableList":e[4]||(e[4]=l=>p(x)?x.value=l:x=l),tablePage:a(u).page,"onUpdate:tablePage":e[5]||(e[5]=l=>a(u).page=l),tablePageNum:a(u).pageNum,"onUpdate:tablePageNum":e[6]||(e[6]=l=>a(u).pageNum=l),tableTotal:a(V),"onUpdate:tableTotal":e[7]||(e[7]=l=>p(V)?V.value=l:V=l),loading:a(g),"onUpdate:loading":e[8]||(e[8]=l=>p(g)?g.value=l:g=l),onTablePageChange:z},null,8,["modelValue","tableList","tablePage","tablePageNum","tableTotal","loading"])]),t(a(M),{modelValue:a(c),"onUpdate:modelValue":e[17]||(e[17]=l=>p(c)?c.value=l:c=l),width:a(U),"onUpdate:width":e[18]||(e[18]=l=>p(U)?U.value=l:U=l),title:a(b),"onUpdate:title":e[19]||(e[19]=l=>p(b)?b.value=l:b=l)},{default:r(()=>[t(ae,null,{default:r(()=>[t(le,{ref:"form",model:a(o),"label-width":"auto",class:"userBox"},{default:r(()=>[t(m,{label:"头像",class:"formItem"},{default:r(()=>[t(q,{"close-on-press-escape":!1,"preview-src-list":[a(o).avatar?a(o).avatar:a(D)],class:"headImg",src:a(o).avatar?a(o).avatar:a(D),fit:"cover"},null,8,["preview-src-list","src"]),t(X,{"file-list":a(v),"onUpdate:fileList":e[9]||(e[9]=l=>p(v)?v.value=l:v=l),action:"http://localhost/api/common/uploadOss",multiple:"","before-upload":H,"show-file-list":!1,accept:".jpg,.jpeg,.png,.gif,.JPG,.JPEG,.GIF,","on-success":K},{default:r(()=>[t(L,{text:"",plain:"",bg:"",type:"primary"},{default:r(()=>[y("点击上传")]),_:1})]),_:1},8,["file-list"])]),_:1}),t(m,{label:"姓名",prop:"name",class:"formItem"},{default:r(()=>[t(h,{modelValue:a(o).name,"onUpdate:modelValue":e[10]||(e[10]=l=>a(o).name=l),type:"text",maxlength:"10","show-word-limit":"",clearable:""},null,8,["modelValue"])]),_:1}),t(m,{label:"性别",prop:"sex",class:"formItem"},{default:r(()=>[t(Y,{modelValue:a(o).sex,"onUpdate:modelValue":e[11]||(e[11]=l=>a(o).sex=l)},{default:r(()=>[t(N,{border:"",label:1},{default:r(()=>[y("男")]),_:1}),t(N,{border:"",label:2},{default:r(()=>[y("女")]),_:1}),t(N,{border:"",label:0},{default:r(()=>[y("未知")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(m,{label:"手机号码",prop:"phone",class:"formItem"},{default:r(()=>[t(h,{modelValue:a(o).phone,"onUpdate:modelValue":e[12]||(e[12]=l=>a(o).phone=l),type:"text",placeholder:"请更新手机号",maxlength:"11","show-word-limit":"",clearable:""},null,8,["modelValue"])]),_:1}),t(m,{label:"邮箱",prop:"email",class:"formItem"},{default:r(()=>[t(h,{modelValue:a(o).email,"onUpdate:modelValue":e[13]||(e[13]=l=>a(o).email=l),type:"text",placeholder:"请更新邮箱","show-word-limit":"",clearable:""},null,8,["modelValue"])]),_:1}),t(m,{label:"登录账号名",prop:"accountName",class:"formItem"},{default:r(()=>[t(h,{disabled:a(_),modelValue:a(o).accountName,"onUpdate:modelValue":e[14]||(e[14]=l=>a(o).accountName=l),type:"text"},null,8,["disabled","modelValue"])]),_:1}),a(_)?se("",!0):(T(),O(m,{key:0,label:"登录密码",prop:"password",class:"formItem"},{default:r(()=>[t(h,{"show-password":"",modelValue:a(o).password,"onUpdate:modelValue":e[15]||(e[15]=l=>a(o).password=l),type:"text"},null,8,["modelValue"])]),_:1})),t(m,{label:"所属角色",prop:"role",class:"formItem"},{default:r(()=>[t(ee,{modelValue:a(o).role,"onUpdate:modelValue":e[16]||(e[16]=l=>a(o).role=l),placeholder:"请选择所属角色",clearable:""},{default:r(()=>[(T(!0),Z(G,null,re(a(C),(l,we)=>(T(),O($,{label:l.name,value:l.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),j("div",be,[t(L,{class:"btn",icon:a(w)?a(ne):"",type:"success",loading:a(d),onClick:Q},{default:r(()=>[y(ue(!a(d)&&!a(w)?"确认":a(w)?a(_)?"修改成功":"创建成功":"正在提交"),1)]),_:1},8,["icon","loading"]),t(L,{class:"btn",onClick:B},{default:r(()=>[y("取消")]),_:1})])]),_:1},8,["modelValue","width","title"])],64)}}},Le=te(ve,[["__scopeId","data-v-7935b35d"]]);export{Le as default};
